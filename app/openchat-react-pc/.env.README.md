# 环境变量配置说明

本文档说明 OpenChat React PC 应用的环境变量配置。

## 环境文件

项目支持以下环境配置文件：

| 文件 | 环境 | 用途 |
|------|------|------|
| `.env.development` | 开发环境 | 本地开发使用 |
| `.env.test` | 测试环境 | 测试/预发布环境 |
| `.env.production` | 生产环境 | 线上生产环境 |

## 环境变量列表

### 应用信息

| 变量名 | 说明 | 示例 |
|--------|------|------|
| `VITE_APP_NAME` | 应用名称 | `OpenChat` |
| `VITE_APP_VERSION` | 应用版本 | `1.0.0` |
| `VITE_DEBUG` | 调试模式 | `true` / `false` |
| `VITE_LOG_LEVEL` | 日志级别 | `debug` / `info` / `warn` / `error` |

### 服务端点配置

| 变量名 | 说明 | 示例 |
|--------|------|------|
| `VITE_API_BASE_URL` | OpenChat Server API 地址 | `http://localhost:3000` |
| `VITE_IM_WS_URL` | 悟空IM WebSocket 地址 | `ws://localhost:5200` |

### RTC 配置

| 变量名 | 说明 | 示例 |
|--------|------|------|
| `VITE_RTC_APP_ID` | RTC App ID | `your-app-id` |
| `VITE_RTC_PROVIDER` | RTC 提供商 | `volcengine` / `agora` |

## 使用方式

### 1. 开发环境启动

```bash
# 使用开发环境配置 (.env.development)
npm run dev

# 或显式指定
npm run dev:dev
```

### 2. 测试环境启动

```bash
# 使用测试环境配置 (.env.test)
npm run dev:test
```

### 3. 生产环境启动

```bash
# 使用生产环境配置 (.env.production)
npm run dev:prod
```

### 4. 构建命令

```bash
# 构建开发环境版本
npm run build:dev

# 构建测试环境版本
npm run build:test

# 构建生产环境版本 (默认)
npm run build
# 或
npm run build:prod
```

### 5. 预览构建产物

```bash
# 预览生产构建
npm run preview

# 预览测试构建
npm run preview:test

# 预览生产构建
npm run preview:prod
```

## 在代码中使用

```typescript
import { 
  API_BASE_URL, 
  IM_WS_URL, 
  APP_VERSION, 
  IS_DEV, 
  IS_PROD,
  DEBUG 
} from '@/app/env';

// 使用环境变量
console.log('API地址:', API_BASE_URL);
console.log('IM地址:', IM_WS_URL);
console.log('版本:', APP_VERSION);
console.log('是否开发环境:', IS_DEV);
```

## 注意事项

1. **变量命名规则**: 所有需要在客户端使用的环境变量必须以 `VITE_` 开头
2. **敏感信息**: 不要将敏感信息（如密钥、密码）放在环境变量中，它们会被打包到客户端代码中
3. **本地覆盖**: 可以创建 `.env.local` 文件来覆盖本地开发配置，该文件不会被提交到 Git
4. **环境判断**: 使用 `import.meta.env.DEV` 和 `import.meta.env.PROD` 判断当前环境

## 自定义环境

如需添加新的环境（如 `staging`）：

1. 创建 `.env.staging` 文件
2. 在 `package.json` 添加启动脚本：
   ```json
   "dev:staging": "vite --mode staging",
   "build:staging": "tsc && vite build --mode staging"
   ```
